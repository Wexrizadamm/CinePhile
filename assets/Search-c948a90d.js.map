{"version":3,"file":"Search-c948a90d.js","sources":["../../src/stores/search.js","../../src/components/Search/Search.vue","../../src/views/Search.vue"],"sourcesContent":["import { defineStore } from \"pinia\";\r\nimport { baseUrl, lang, header_def } from \"@/static\";\r\nimport axios from \"axios\";\r\n\r\nexport const useSearch = defineStore(\"search\", {\r\n  state: () => ({\r\n    saerchArray: [],\r\n    adult: false,\r\n    totalResults: 0,\r\n    totalPages: 0,\r\n  }),\r\n  actions: {\r\n    async getSearch(search = \"\", page = 1) {\r\n      if (search != \"\") {\r\n        try {\r\n          const res = await axios({\r\n            method: \"GET\",\r\n            url: `${baseUrl}/search/multi?query=${search}&include_adult=${this.adult}&language=${lang}&page=${page}`,\r\n            headers: header_def,\r\n          });\r\n\r\n          this.saerchArray = res.data.results;\r\n          this.totalPages = res.data.total_pages;\r\n          this.totalResults = res.data.total_results;\r\n        } catch (error) {\r\n          console.error(\"Error in search.js\");\r\n        }\r\n      } else {\r\n        this.saerchArray = [];\r\n        this.totalPages = 0;\r\n        this.totalResults = 0;\r\n      }\r\n    },\r\n  },\r\n});\r\n","<template>\r\n  <section class=\"search\">\r\n    <div class=\"container\">\r\n      <div class=\"search__top\">\r\n        <input\r\n          type=\"text\"\r\n          class=\"search__input\"\r\n          :placeholder=\"placeholder\"\r\n          v-model=\"searchValue\"\r\n          @keydown.enter=\"getSearch()\"\r\n        />\r\n        <button class=\"search__button\" v-if=\"searchValue\" @click=\"clearInput\">\r\n          <i class=\"fal fa-times\"></i>\r\n        </button>\r\n      </div>\r\n      <div class=\"content__list\">\r\n        <ContentItem\r\n          v-for=\"content in searchArray\"\r\n          :key=\"content.id\"\r\n          :content=\"content\"\r\n          :type=\"content.media_type\"\r\n        />\r\n      </div>\r\n      <div class=\"content__pagination\" v-if=\"totalPages > 0\">\r\n        <vue-awesome-paginate\r\n          :total-items=\"totalItem\"\r\n          :items-per-page=\"20\"\r\n          :max-page-shown=\"5\"\r\n          v-model=\"page\"\r\n          :on-click=\"getSearch\"\r\n        />\r\n      </div>\r\n    </div>\r\n  </section>\r\n  <Loader v-if=\"loading\" />\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from \"vue\";\r\nimport { useSearch } from \"@/stores/search\";\r\nimport ContentItem from \"@/components/UI/ContentItem.vue\";\r\n\r\nconst searchStore = useSearch();\r\nconst placeholder = ref(\"Найти фильм, сериал...\");\r\nconst searchArray = ref([]);\r\nconst totalPages = computed(() => searchStore.totalPages);\r\nconst totalItem = computed(() => searchStore.totalResults);\r\nlet searchValue = ref(\"\");\r\nlet page = ref(1);\r\nlet loading = ref(false);\r\n\r\nconst getSearch = async () => {\r\n  if (!loading.value) {\r\n    loading.value = true;\r\n    searchArray.value = [];\r\n    await searchStore.getSearch(searchValue.value, page.value);\r\n    let state = searchStore.saerchArray;\r\n    searchArray.value.push(...state);\r\n    loading.value = false;\r\n    page + 1;\r\n    scrollTo({\r\n      behavior: \"smooth\",\r\n      top: 0,\r\n    });\r\n  }\r\n};\r\n\r\nconst clearInput = () => {\r\n  loading.value = true;\r\n  searchValue.value = \"\";\r\n  searchArray.value = [];\r\n  searchStore.saerchArray = [];\r\n  searchStore.totalPages = 0;\r\n  searchStore.totalResults = 0;\r\n  loading.value = false;\r\n};\r\n\r\nonMounted(() => {\r\n  scrollTo({\r\n    behavior: \"smooth\",\r\n    top: 0,\r\n  });\r\n});\r\n</script>\r\n","<template>\r\n  <main class=\"main\">\r\n    <Search />\r\n  </main>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted } from \"vue\";\r\nimport Search from \"@/components/Search/Search.vue\";\r\nimport { useSearch } from \"@/stores/search\";\r\n\r\nconst searchStore = useSearch();\r\n\r\nonMounted(() => {\r\n  searchStore.searchArray = [];\r\n  searchStore.totalPages = 0;\r\n  searchStore.totalResults = 0;\r\n});\r\n</script>\r\n"],"names":["useSearch","defineStore","search","page","res","axios","baseUrl","lang","header_def","searchStore","placeholder","ref","searchArray","totalPages","computed","totalItem","searchValue","loading","getSearch","state","clearInput","onMounted"],"mappings":"yOAIO,MAAMA,EAAYC,EAAY,SAAU,CAC7C,MAAO,KAAO,CACZ,YAAa,CAAE,EACf,MAAO,GACP,aAAc,EACd,WAAY,CAChB,GACE,QAAS,CACP,MAAM,UAAUC,EAAS,GAAIC,EAAO,EAAG,CACrC,GAAID,GAAU,GACZ,GAAI,CACF,MAAME,EAAM,MAAMC,EAAM,CACtB,OAAQ,MACR,IAAK,GAAGC,wBAA8BJ,mBAAwB,KAAK,kBAAkBK,UAAaJ,IAClG,QAASK,CACrB,CAAW,EAED,KAAK,YAAcJ,EAAI,KAAK,QAC5B,KAAK,WAAaA,EAAI,KAAK,YAC3B,KAAK,aAAeA,EAAI,KAAK,aAC9B,MAAC,CACA,QAAQ,MAAM,oBAAoB,CACnC,MAED,KAAK,YAAc,GACnB,KAAK,WAAa,EAClB,KAAK,aAAe,CAEvB,CACF,CACH,CAAC,+NCQD,MAAMK,EAAcT,EAAS,EACvBU,EAAcC,EAAI,wBAAwB,EAC1CC,EAAcD,EAAI,CAAA,CAAE,EACpBE,EAAaC,EAAS,IAAML,EAAY,UAAU,EAClDM,EAAYD,EAAS,IAAML,EAAY,YAAY,EACzD,IAAIO,EAAcL,EAAI,EAAE,EACpBR,EAAOQ,EAAI,CAAC,EACZM,EAAUN,EAAI,EAAK,EAEvB,MAAMO,EAAY,SAAY,CAC5B,GAAI,CAACD,EAAQ,MAAO,CAClBA,EAAQ,MAAQ,GAChBL,EAAY,MAAQ,GACpB,MAAMH,EAAY,UAAUO,EAAY,MAAOb,EAAK,KAAK,EACzD,IAAIgB,EAAQV,EAAY,YACxBG,EAAY,MAAM,KAAK,GAAGO,CAAK,EAC/BF,EAAQ,MAAQ,GAEhB,SAAS,CACP,SAAU,SACV,IAAK,CACX,CAAK,EAEL,EAEMG,EAAa,IAAM,CACvBH,EAAQ,MAAQ,GAChBD,EAAY,MAAQ,GACpBJ,EAAY,MAAQ,GACpBH,EAAY,YAAc,GAC1BA,EAAY,WAAa,EACzBA,EAAY,aAAe,EAC3BQ,EAAQ,MAAQ,EAClB,EAEA,OAAAI,EAAU,IAAM,CACd,SAAS,CACP,SAAU,SACV,IAAK,CACT,CAAG,CACH,CAAC,2zBCvED,MAAMZ,EAAcT,EAAS,EAE7B,OAAAqB,EAAU,IAAM,CACdZ,EAAY,YAAc,GAC1BA,EAAY,WAAa,EACzBA,EAAY,aAAe,CAC7B,CAAC"}